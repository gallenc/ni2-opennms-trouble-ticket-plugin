<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Ni2 OpenNMS Trouble Ticket Plugin Administrators Guide</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #212121; padding: 0; margin: 0; font-family: "Roboto", sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.stretch { width: 100%; }

p.lead { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.45; color: #212121; font-weight: 300; margin-top: 0; margin-bottom: 0.25em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #212121; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #4d9c2d; }
a img { border: none; }

#content a { color: #212121; text-decoration: none; border-bottom: 0.75px dashed #212121; line-height: inherit; }
#content a:hover, a:focus { color: #4d9c2d; border-bottom: 0.75px dashed #4d9c2d; }
#content a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Roboto", sans-serif; font-weight: bold; font-style: normal; color: #444; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.0125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #e99b8f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #ddddd8; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: "Roboto Mono", monospace; font-weight: normal; color: rgba(0, 0, 0, 0.9); }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #212121; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.9375em; color: rgba(0, 0, 0, 0.6); }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: rgba(0, 0, 0, 0.6); }

blockquote, blockquote p { line-height: 1.6; color: rgba(0, 0, 0, 0.85); }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dedede; }
table thead, table tfoot { background: #f7f8f7; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #212121; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #212121; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f7f7f7; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.6; }

body { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; word-spacing: -0.05em; }
h1 strong, h2 strong, h3 strong, #toctitle strong, .sidebarblock > .content > .title strong, h4 strong, h5 strong, h6 strong { font-weight: 400; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: 0.9375em; font-style: normal !important; letter-spacing: 0; padding: 0.1em 0.5ex; word-spacing: -0.15em; background-color: #f7f7f7; -webkit-border-radius: 4px; border-radius: 4px; line-height: 1.45; text-rendering: optimizeSpeed; word-wrap: break-word; }
*:not(pre) > code.nobreak { word-wrap: normal; }
*:not(pre) > code.nowrap { white-space: nowrap; }

pre, pre > code { line-height: 1.45; color: rgba(0, 0, 0, 0.9); font-family: "Roboto Mono", "Droid Sans Mono", "DejaVu Sans Mono", "Monospace", monospace; font-weight: normal; text-rendering: optimizeSpeed; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: rgba(51, 51, 51, 0.8); }

kbd { font-family: "Roboto Mono", monospace; display: inline-block; color: #212121; font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menuref { color: #000; }

.menuseq b:not(.caret), .menuref { font-weight: inherit; }

.menuseq { word-spacing: -0.02em; }
.menuseq b.caret { font-size: 1.25em; line-height: 0.8; }
.menuseq i.caret { font-weight: bold; text-align: center; width: 0.45em; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

p a > code:hover { color: rgba(0, 0, 0, 0.9); }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: rgba(0, 0, 0, 0.85); margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #ddddd8; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #ddddd8; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #ddddd8; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: rgba(0, 0, 0, 0.6); display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: rgba(0, 0, 0, 0.85); }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: rgba(0, 0, 0, 0.85); }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: rgba(0, 0, 0, 0.85); border-bottom: 1px solid #ddddd8; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 1px solid #efefed; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Roboto", sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none !important;}
#toc a:active { text-decoration: none; }

#toctitle { color: #444; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f7f7f7; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #efefed; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #efefed; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f7f7f7; -webkit-border-radius: 4px; border-radius: 4px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: #212121; padding: 1.25em; }

#footer-text { color: rgba(255, 255, 255, 0.8); line-height: 1.44; }

#content { margin-bottom: 0.625em; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { #content { margin-bottom: 1.25em; }
  .sect1 { padding-bottom: 1.25em; } }
.sect1:last-child { padding-bottom: 0; }

.sect1 + .sect1 { border-top: 1px solid #efefed; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #444; text-decoration: none; font-weight: bold;}
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #444;}

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock { background-color: #f7f7f7; }
.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; font-family: "Roboto", Arial, Helvetica, sans-serif; font-size: 1rem; }

table.tableblock.fit-content > caption.title { white-space: nowrap; width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > [class="paragraph"]:first-of-type p { font-size: 1.21875em; line-height: 1.6; color: rgba(0, 0, 0, 0.85); }

table.tableblock #preamble > .sectionbody > [class="paragraph"]:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Roboto", sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #ddddd8; color: rgba(0, 0, 0, 0.6); }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 4px; border-radius: 4px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f7f7f7; -webkit-border-radius: 4px; border-radius: 4px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #444; margin-top: 0; text-align: center; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #f7f7f7; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { -webkit-border-radius: 4px; border-radius: 4px; word-wrap: break-word; padding: 1em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #f7f7f7; background-color: rgba(0, 0, 0, 0.9); }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1em; -webkit-border-radius: 4px; border-radius: 4px; }

.listingblock pre.prettyprint { border-width: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.45; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #ddddd8; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: rgba(0, 0, 0, 0.85); font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #444; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid rgba(0, 0, 0, 0.6); }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Roboto", sans-serif; font-size: 1.15rem; color: rgba(0, 0, 0, 0.85); font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.9375em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: rgba(0, 0, 0, 0.6); }

.quoteblock.abstract { margin: 0 1em 1.25em 1em; display: block; }
.quoteblock.abstract > .title { margin: 0 0 0.375em 0; font-size: 1.15em; text-align: center; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { word-spacing: 0; line-height: 1.6; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract p:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }

p.tableblock:last-child { margin-bottom: 0; }

td.tableblock > .content { margin-bottom: -1.25em; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dedede; }

table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock { border-width: 0 1px 1px 0; }

table.grid-all > tfoot > tr > .tableblock { border-width: 1px 1px 0 0; }

table.grid-cols > * > tr > .tableblock { border-width: 0 1px 0 0; }

table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock { border-width: 0 0 1px 0; }

table.grid-rows > tfoot > tr > .tableblock { border-width: 1px 0 0 0; }

table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock { border-bottom-width: 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot, table.frame-ends { border-width: 1px 0; }

table.stripes-all tr, table.stripes-odd tr:nth-of-type(odd) { background: #f7f7f7; }

table.stripes-none tr, table.stripes-odd tr:nth-of-type(even) { background: none; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.6; background: #f7f8f7; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #212121; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.checklist, ul.none, ol.none, ul.no-bullet, ol.no-bullet, ol.unnumbered, ul.unstyled, ol.unstyled { list-style-type: none; }

ul.no-bullet, ol.no-bullet, ol.unnumbered { margin-left: 0.625em; }

ul.unstyled, ol.unstyled { margin-left: 0; }

ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1.25em; font-size: 0.8em; position: relative; bottom: 0.125em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.inline { display: -ms-flexbox; display: -webkit-box; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; list-style: none; margin: 0 0 0.625em -1.25em; }

ul.inline > li { margin-left: 1.25em; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 1.25em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist td:not([class]):first-child { padding: 0.4em 0.75em 0 0.75em; line-height: 1; vertical-align: top; }
.colist td:not([class]):first-child img { max-width: none; }
.colist td:not([class]):last-child { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; margin-left: -1.05em; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }
a span.icon > .fa { cursor: inherit; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #3465a4; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; color: #444; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #f57900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #cc0000; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #cc0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: #212121; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Roboto", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

dt, th.tableblock, td.content, div.footnote { text-rendering: optimizeLegibility; }

h1, h2, p, td.content, span.alt { letter-spacing: -0.01em; }

p strong, td.content strong, div.footnote strong { letter-spacing: -0.005em; }

p, blockquote, dt, td.content, span.alt { font-size: 1.0625rem; }

p { margin-bottom: 1.25rem; }

.sidebarblock p, .sidebarblock dt, .sidebarblock td.content, p.tableblock { font-size: 1em; }

.exampleblock > .content { background-color: #fffef7; border-color: #e0e0dc; -webkit-box-shadow: 0 1px 4px #e0e0dc; box-shadow: 0 1px 4px #e0e0dc; }

.print-only { display: none !important; }

@page { margin: 1.25cm 0.75cm; }

@media print { * { -webkit-box-shadow: none !important; box-shadow: none !important; text-shadow: none !important; }
  html { font-size: 80%; }
  a { color: inherit !important; text-decoration: underline !important; }
  a.bare, a[href^="#"], a[href^="mailto:"] { text-decoration: none !important; }
  a[href^="http:"]:not(.bare):after, a[href^="https:"]:not(.bare):after { content: "(" attr(href) ")"; display: inline-block; font-size: 0.875em; padding-left: 0.25em; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  pre, blockquote, tr, img, object, svg { page-break-inside: avoid; }
  thead { display: table-header-group; }
  svg { max-width: 100%; }
  p, blockquote, dt, td.content { font-size: 1em; orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  #toc, .sidebarblock, .exampleblock > .content { background: none !important; }
  #toc { border-bottom: 1px solid #ddddd8 !important; padding-bottom: 0 !important; }
  body.book #header { text-align: center; }
  body.book #header > h1:first-child { border: 0 !important; margin: 2.5em 0 1em 0; }
  body.book #header .details { border: 0 !important; display: block; padding: 0 !important; }
  body.book #header .details span:first-child { margin-left: 0 !important; }
  body.book #header .details br { display: block; }
  body.book #header .details br + span:before { content: none !important; }
  body.book #toc { border: 0 !important; text-align: left !important; padding: 0 !important; margin: 0 !important; }
  body.book #toc, body.book #preamble, body.book h1.sect0, body.book .sect1 > h2 { page-break-before: always; }
  .listingblock code[data-lang]:before { display: block; }
  #footer { padding: 0 0.9375em; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
@media print, amzn-kf8 { #header > h1:first-child { margin-top: 1.25rem; }
  .sect1 { padding: 0 !important; }
  .sect1 + .sect1 { border: 0; }
  #footer { background: none; }
  #footer-text { color: rgba(0, 0, 0, 0.6); font-size: 0.9em; } }
@media amzn-kf8 { #header, #content, #footnotes, #footer { padding: 0; } }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body id="ga" class="book toc2 toc-left">
<div id="header">
<h1>Ni2 OpenNMS Trouble Ticket Plugin Administrators Guide</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#ga-admin-about">1. About This Guide</a>
<ul class="sectlevel2">
<li><a href="#ga-admin-audience">1.1. Audience</a></li>
<li><a href="#ga-admin-docs-related">1.2. Related Documentation</a></li>
<li><a href="#ga-admin-legal">1.3. Legal Notice</a></li>
</ul>
</li>
<li><a href="#ga-overview">2. Overview</a>
<ul class="sectlevel2">
<li><a href="#_introduction_to_the_ni2_opennms_trouble_ticket_plugin">2.1. Introduction to the Ni2 OpenNMS Trouble Ticket Plugin</a></li>
<li><a href="#_manually_creating_a_ticket">2.2. Manually creating a ticket</a></li>
<li><a href="#_ticket_lifecycle">2.3. Ticket Lifecycle</a></li>
</ul>
</li>
<li><a href="#ga-admin">3. Ni2 OpenNMS Trouble Ticket Plugin Administration</a>
<ul class="sectlevel2">
<li><a href="#_introduction">3.1. Introduction</a></li>
<li><a href="#_installation">3.2. Installation</a></li>
<li><a href="#_configuration">3.3. Configuration</a>
<ul class="sectlevel3">
<li><a href="#_deploy_ni2_tt_api_v1_kar_x_x_x_kar">3.3.1. deploy ni2-tt-api-v1-kar-x.x.x.kar</a></li>
<li><a href="#_ni2_plugin_configuration">3.3.2. ni2 Plugin configuration</a></li>
</ul>
</li>
<li><a href="#_running_and_testing_the_plugin">3.4. Running and Testing the Plugin</a></li>
</ul>
</li>
<li><a href="#ga-develop">4. Ni2 OpenNMS Trouble Ticket Plugin Developers Guide</a>
<ul class="sectlevel2">
<li><a href="#_introduction_2">4.1. Introduction</a></li>
<li><a href="#_building_the_plugin">4.2. building the plugin</a></li>
<li><a href="#_maven_modules">4.3. Maven Modules</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="ga-admin-about">1. About This Guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Welcome to the Ni2 OpenNMS Trouble Ticket Plugin <em>Administrators Guide</em>.
This documentation provides information and procedures on setup, configuration, and use of the Ni2 OpenNMS Trouble Ticket Plugin.</p>
</div>
<div class="sect2">
<h3 id="ga-admin-audience">1.1. Audience</h3>
<div class="paragraph">
<p>This guide is suitable for administrative users and those who will use the Ni2 OpenNMS Trouble Ticket Plugin to integrate OpenNMS with their ticketing system.</p>
</div>
</div>
<div class="sect2">
<h3 id="ga-admin-docs-related">1.2. Related Documentation</h3>
<div class="paragraph">
<p><a href="https://docs.opennms.com/start-page/1.0.0/index.html">OpenNMS Documentation</a>: OpenNMS Documentation</p>
</div>
<div class="paragraph">
<p><a href="https://docs.opennms.com/horizon/33/operation/deep-dive/ticketing/introduction.html">OpenNMS Trouble Ticket Engine</a>: information on the operation of OpenNMS trouble ticketing</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenNMS/opennms-integration-api">OpenNMS Integration Api</a>: OpenNMS Integration Api used to drive this plugin</p>
</div>
</div>
<div class="sect2">
<h3 id="ga-admin-legal">1.3. Legal Notice</h3>
<div class="paragraph">
<p>Copyright © 2024 (c) 2024 Ni2 Inc., Entimoss Ltd., The OpenNMS Group, Inc. and other contributors.</p>
</div>
<div class="paragraph">
<p>OpenNMS is a registered trademark of The OpenNMS Group, Inc.</p>
</div>
<div class="paragraph">
<p>All other trademarks are the property of their respective owners.</p>
</div>
<div class="paragraph">
<p>Documentation Content in this repository is licensed under a Creative Commons Attribution 4.0 International (CC BY 4.0) license.</p>
</div>
<div class="paragraph">
<p>You can find the complete text of this license at <a href="http://creativecommons.org/licenses/by/4.0/" class="bare">http://creativecommons.org/licenses/by/4.0/</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga-overview">2. Overview</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction_to_the_ni2_opennms_trouble_ticket_plugin">2.1. Introduction to the Ni2 OpenNMS Trouble Ticket Plugin</h3>
<div class="paragraph">
<p>The Ni2 OpenNMS Trouble Ticket Plugin is an open source OSGi plugin which integrates OpenNMS with the Ni2 Trouble Ticketing Engine.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/overview/overview.drawio.png" alt="Overview of Ni2 Ticketing Plugin">
</div>
</div>
<div class="paragraph">
<p>Ni2 provides a ReST api which the plugin uses to create and update tickets.</p>
</div>
<div class="paragraph">
<p>OSGi is a standard mechanism which OpenNMS uses to allow 'plugins' to be deployed and add functionality to a standard OpenNMS release.</p>
</div>
<div class="paragraph">
<p>The plugin is provided as a karaf .kar file (a kind of zip file) which is placed in the OpenNMS deploy directory.
The corresponding configuration files for the plugin are placed in the OpenNMS etc directory.
A full description of the installation and configuration options are provided later in this guide.</p>
</div>
<div class="paragraph">
<p>When the ticketing plugin is correctly installed and configured, additional options to manually create, update and close tickets are provided on the Alarm UI.
Automated creation of tickets for new alarms is also possible and this is covered in the configuration section.</p>
</div>
</div>
<div class="sect2">
<h3 id="_manually_creating_a_ticket">2.2. Manually creating a ticket</h3>
<div class="paragraph">
<p>All current alarms are visible in the Alarms page of OpenNMS.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/overview/alarmList1.png" alt="Alarm List">
</div>
</div>
<div class="paragraph">
<p>Selecting the ID of an alarm will take you to the alarm details page for that alarm.
A new alarm with no associate ticket is illustrated below</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/overview/alarmExampleNOTICKET.png" alt="Alarm with no associated ticket">
</div>
</div>
<div class="paragraph">
<p>When the <code>Create Ticket</code> button is pressed, the ticket state changes to <code>CREATE_PENDING</code>, and if the create is successful, refreshing the alarm page will show the ticket as OPEN and a new reference link to the ticket will also be created.
Selecting this link will take you to the corresponding page for the ticket created in Ni2.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/overview/alarmExampleOPEN.png" alt="Alarm with an OPEN associated ticket">
</div>
</div>
<div class="paragraph">
<p>If the create was not successful, a <code>CREATE_FAILED</code> message will appear.
This can happen if the ReST API credentials are not set properly or if the Node Name associated with the alarm is not known as a resource id in the Ni2 system.
The configuration section will talk more about troubleshooting ticket creation issues.</p>
</div>
<div class="paragraph">
<p>The Update Ticket button requests the current state of an associated ticket in Ni2 (without changing its state).</p>
</div>
<div class="paragraph">
<p>The <code>Close Ticket</code> button can only be pressed if the associated alarm is already <code>CLEARED</code>.
It sets the state of the ticket in Ni2 to <code>RESOLVED</code> (Although this is reflected on the OpenNNS UI as <code>CLOSED</code>)</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/overview/alarmExampleCLOSED.png" alt="Alarm with a CLOSED associated ticket">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ticket_lifecycle">2.3. Ticket Lifecycle</h3>
<div class="paragraph">
<p>OpenNMS has a very simple lifecycle for tickets.</p>
</div>
<div class="paragraph">
<p>Tickets associated with alarms can be in one of the following states: <code>OPEN, CANCELLED, CLOSED</code>. Alarms will only be deleted if the associated tickets are <code>CANCELLED</code> or <code>CLOSED</code>.</p>
</div>
<div class="paragraph">
<p>Ni2 has a richer lifecycle illustrated below</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/overview/ni2Lifecycle.png" alt="Ni2 Ticket Lifecycle">
</div>
</div>
<div class="paragraph">
<p>The mapping between Ni2 tickets and OpenNMS ticket states is as follows</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Ni2 Ticket Status</th>
<th class="tableblock halign-left valign-top">OpenNMS Ticket Status</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IN_PROCESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPEN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPEN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLOSED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLOSED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CANCELLED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CANCELLED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESOLVED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLOSED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">any other Ni2 State</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPEN</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The ticket state shown on the alarm UI reflects the current state of the Ni2 ticket and can be updated using the <code>Update</code> button.
OpenNMS can request the creation of new tickets but it can only set tickets into the resolved state if they have been set to the <code>IN_PROCESS</code> state by an Ni2 operator.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga-admin">3. Ni2 OpenNMS Trouble Ticket Plugin Administration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction">3.1. Introduction</h3>
<div class="paragraph">
<p>The internal architecture of OpenNMS ticketing is illustrated below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/admin/architecture-2.drawio.png" alt="OpenNMS Event" width="Alarm and Ticketing Architecture">
</div>
</div>
<div class="paragraph">
<p>All of the processes within OpenNMS are gradually being migrated into OSGi but a number of features are still, for historical reasons,  daemons running within the core.
This includes a number of the ticketing interfaces developed before OSGi was introduced.
You can see in this diagram that Eventd, Alarmd and Ticketd are mostly non-OSGi processes.
The OSGI Ticketing Service bridges the Ticketd api into Karaf so that ticketing interfaces built as OSGi plugins can be found and used by the Ticketd daemon.</p>
</div>
<div class="paragraph">
<p>OpenNMS is an event driven application and Eventd provides an internal unified event bus through which all processes communicate inside OpenNMS core.
Events can be derived from syslog messages sing syslogd or from SDMP traps using trapd.
Internal OpenNMS events are also published by various service assurance processes such as pollerd.</p>
</div>
<div class="paragraph">
<p><code>eventconf.xml</code> and its related include files in `/etc/events' are used to configure how traps and other events are mapped into alarms and what descriptive text is used to describe the event.</p>
</div>
<div class="paragraph">
<p>Alarmd listens for events which are configured to create or clear alarms.
Jboss rules (Drools) is used to define the lifecycle of alarms.
Once an event has created an alarm it is a candidate to map to a new trouble ticket and dules can also be used to determine when and how alarms might automatically create trouble tickets.
The Alarmd rules files are contained in `etc/alarmd.drools.d' and example alarm ticket rules are contained in the alarm.drl file in this folder.</p>
</div>
<div class="paragraph">
<p>Ticketd provides a ticketing service which Alarmd uses to create tickets for alarms.
It also listens for ticket create and update events which are created by users through the Alarm UI.
The generic ticketing engine must be configured to use the correct api to talk to the correct ticket application.</p>
</div>
<div class="paragraph">
<p>Ticketd can be configured to use the in built ticketing interfaces or to use the OSGi ticketing service which allows it to find any ticketing plugin currently active in the system.
Only one ticketing plugin can be used at a time so ensure only one is active otherwise the first one found will be used.</p>
</div>
<div class="paragraph">
<p>Ticketd can optionally use the DroolsTicketerServiceLayer which allow a drools rule file to define how alarm and node data are mapped into the ticket.
We use this to refine the mapping of data into the Ni2 tickets.</p>
</div>
<div class="paragraph">
<p>The following sections will discuss how to install and configure the ticket plugin in more detail.</p>
</div>
</div>
<div class="sect2">
<h3 id="_installation">3.2. Installation</h3>
<div class="paragraph">
<p>The OpenNMS OSGi ticketing integration provides a generic mechanism for linking OpenNMS Alarms to trouble tickets.
A number of different ticketing integrations are provided and the newest integrations are provided as OSGi plugins.
OSGi provides a flexible mechanism to install new features in OpenNMS without modifying the core code.
The Ni2 Trouble Ticketing plugin is implemented as an OSGi feature.</p>
</div>
<div class="paragraph">
<p>The following figure illustrates the folder layout in an OpenNMS system (on a VM or in a container) and how this maps onto the docker-compose project provided as an example.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/admin/opennmsFolders.drawio.png" alt="OpenNMS Folders">
</div>
</div>
<div class="paragraph">
<p>The plugin can be downloaded as a kar file from the releases section of the github repo  <a href="https://github.com/gallenc/ni2-opennms-trouble-ticket-plugin/releases" class="bare">https://github.com/gallenc/ni2-opennms-trouble-ticket-plugin/releases</a></p>
</div>
<div class="paragraph">
<p>This should be placed in the OpenNMS <code>deploy</code> folder.</p>
</div>
<div class="paragraph">
<p>The plugin will not become active until the following configuration steps are taken</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuration">3.3. Configuration</h3>
<div class="paragraph">
<p>Note that an example configuration is provided in the minimal-minion-activemq docker compose project.
You should copy and modify files from this project to create the configuration for your system.
(This configuration is based on OpenNMS 32.0.5)</p>
</div>
<div class="paragraph">
<p>In order to install and enable the plugin changes need to be made in several places.</p>
</div>
<div class="sect3">
<h4 id="_deploy_ni2_tt_api_v1_kar_x_x_x_kar">3.3.1. deploy ni2-tt-api-v1-kar-x.x.x.kar</h4>
<div class="paragraph">
<p>Firstly you should download the ni2-tt-api-v1-kar-XXX.kar file (where XXX is the current version number) from the github folder</p>
</div>
<div class="paragraph">
<p>[ni2-opennms-trouble-ticket-plugin/releases](<a href="https://github.com/gallenc/ni2-opennms-trouble-ticket-plugin/releases" class="bare">https://github.com/gallenc/ni2-opennms-trouble-ticket-plugin/releases</a>)</p>
</div>
<div class="paragraph">
<p>e.g. wget  <a href="https://github.com/gallenc/ni2-opennms-trouble-ticket-plugin/releases/download/v0.0.1/ni2-tt-api-v1-kar-0.0.1.kar" class="bare">https://github.com/gallenc/ni2-opennms-trouble-ticket-plugin/releases/download/v0.0.1/ni2-tt-api-v1-kar-0.0.1.kar</a></p>
</div>
<div class="paragraph">
<p>Install this file in the karaf deploy directory <code>-opennms-home-/deploy</code></p>
</div>
<div class="paragraph">
<p>To automatically enable the ni2 plugin on startup, modify <code>-opennms-home-/etc/org.apache.karaf.features.cfg</code></p>
</div>
<div class="paragraph">
<p>Add <code>ni2-ticketing</code> to the end of the featuresBoot property but before <code>opennms-karaf-health</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>featuresBoot = ( \
  ...
  scv-shell, \
  ni2-ticketing, \
  opennms-karaf-health
# Ensure that the 'opennms-karaf-health' feature is installed *last*</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ni2_plugin_configuration">3.3.2. ni2 Plugin configuration</h4>
<div class="sect4">
<h5 id="_ni2_properties_file">Ni2 properties file</h5>
<div class="paragraph">
<p>The main properties for the ni2 plugin are held in <code>-opennms-home-/etc/opennms.properties.d/ni2-troubleticket.properties</code> which should not be checked into git since it contains sensitive passwords.</p>
</div>
<div class="paragraph">
<p>Instead copy/rename the template and change the values accordingly <code>-opennms-home-/etc/opennms.properties.d/ni2-troubleticket.properties.template</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code># This file contains configuration properties for the Ni2 Trouble Ticket Plugin
#
# RENAME or copy this file to ni2-troubleticket.properties and change values appropriately
# DO NOT check passwords into git

# url of the Ni2 trouble ticket server
ni2.tt.server.url=http://localhost:8080

# username to access api
ni2.tt.server.username=username

# password to access api
ni2.tt.server.password=password

# client timeout (ms)
ni2.tt.opennms.clienttimeout=12000

# if true the client will trust all TLS/HTTPS certificates from server
ni2.tt.server.trustallcertificates=true

# identify of the OpenNMS system sending tickets to the server
ni2.tt.opennms.instance=OpenNMS1

# resource id to be used if not passed in ticket attributes from drools
ni2.tt.opennms.fallbackresource="set_fallback_resource";

# see OpenNMS documentation https://docs.opennms.com/horizon/33/operation/deep-dive/ticketing/introduction.html

# this tells the ticketing engine to look for an OSGi plugin exposing he ticketing interface.
# Only one OSGi ticketing plugin can be active at a time and the system will use the first one to be registered.
# (Ensure you only have one OSGi ticketing feature installed at a time)
opennms.ticketer.plugin=org.opennms.netmgt.ticketd.OSGiBasedTicketerPlugin

opennms.alarmTroubleTicketEnabled=true

# note this should be set up to get the url linking to the ticket on the web ui
opennms.alarmTroubleTicketLinkTemplate=http://localhost:8080/Ni2CMDBWebApi/overviewByCategoryAndAttribute/Event/UniversalId/${id}

# this sets up rules for mapping values in alarms and nodes to tickets
opennms.ticketer.servicelayer=org.opennms.netmgt.ticketd.DroolsTicketerServiceLayer

## note you must also set the rules file in  /etc/drools-ticketer.properties
## drools-ticketer.rules-file=/opt/opennms/etc/ni2-drools-ticketer-rules.drl</code></pre>
</div>
</div>
<div class="paragraph">
<p>Most of the properties in the example file are self explanatory but some require extra mention below.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">property</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2.tt.opennms.instance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This tells Ni2 which instance of OpenNMS raised the ticket. It should be combined with the alarm id to give a unique reference for the alarm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2.tt.opennms.fallbackresource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ni2 must have a resource which it recognises referenced in every ticket. However some alarms in OpenNMS will not have a resource&lt;BR&gt;In this case, the fallback resource will be used. (probably this shouldl just reference the OpenNMS system itself)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">opennms.alarmTroubleTicketLinkTemplate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is used to create a HREF link which will redirect the user to the Ni2 ticket.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note that the properties set in this file are used as default values when karaf CLI commands are issued to test ticket generation.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ni2_osgi_drools_ticketer_mapping">Ni2 OSGi Drools Ticketer mapping</h5>
<div class="paragraph">
<p>The DroolsTicketerServiceLayer uses a set of drools rools to map OpenNMS Alarm and Node information into an OpenNMS ticket.
The Ni2 plugin maps the OpenNMS ticktet to an ni2 trouble ticket.</p>
</div>
<div class="paragraph">
<p>The <code>-opennms-home-/etc/drools-ticketer.properties</code> file tells the DroolsTicketerServiceLayer where the drools rules file is stored</p>
</div>
<div class="paragraph">
<p>create a the file and add the following elements</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>#
# Drools Ticketer Configuration for ni2
#
drools-ticketer.rules-file=/opt/opennms/etc/ni2-drools-ticketer-rules.drl
```

Example rules are provided in

`-opennms-home-/etc/ni2-drools-ticketer-rules.drl`

```
package org.opennms.netmgt.ticketd;
import org.opennms.netmgt.model.OnmsAlarm;
import org.opennms.netmgt.model.OnmsNode;
import org.opennms.netmgt.model.OnmsCategory;
import org.opennms.api.integration.ticketing.Ticket;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document.OutputSettings;
import org.jsoup.safety.Whitelist;

dialect "mvel"

global Ticket ticket;

/*
 * Set tickets defaults
*/

rule "TicketDefaults"
salience 100
 when
  $alarm : OnmsAlarm()
  $node  : OnmsNode()

 then
  // note bug - must set ticket.alarmId as not set by service
  ticket.alarmId = $alarm.id

  ticket.summary = $alarm.logMsg

  // keeps html in alarm description
  // ticket.details = $alarm.description

  // removes html tags but preserves line feeds
  ticket.details = Jsoup.clean($alarm.description, "", Whitelist.none(), new OutputSettings().prettyPrint(false));

  ticket.addAttribute("ni2.tt.resourceids", $node.label);

  // use for more exact resource id using foreign source and foreign id.
  // ticket.addAttribute("ni2.tt.resourceids", $node.foreignSource:$node.foreignId);

end</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see that ticket information is extracted from the alarm and node information.</p>
</div>
<div class="paragraph">
<p>In this example, we have simply mapped the alarm log message to the ticket.summary.</p>
</div>
<div class="paragraph">
<p>We have used Jsoup to remove all of the HTML tags from the alarm description and placed this in the ticket.details</p>
</div>
<div class="paragraph">
<p>OpennMS Tickets can contain an arbitrary number of attributes mapped as name value pairs.</p>
</div>
<div class="paragraph">
<p>These are mapped into ni2 tickets as follows</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">OpenNMS Ticket Attribute name</th>
<th class="tableblock halign-left valign-top">Ni2 Ticket mapping</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2.tt.resourceids</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This should contain a comma separated list of Ni2 Resource ids to map to the ticket. The example just provides one resource, the node label.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2.tt.attributes.XXX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">this will be mapped to an arbirary ni2 ticket custom attribte, with the name set to the value of the text after attributes. (i.e. the XXX characters)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>It is possible to add more rules which can process alarms into tickets differently depending on the data in the alarm or node objects.</p>
</div>
<div class="paragraph">
<p>For information, the objects referenced in drools are</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">drools reference</th>
<th class="tableblock halign-left valign-top">OpenNMS object (on github)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ticket</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/OpenNMS/opennms/blob/opennms-32.0.5-1/features/ticketing/api/src/main/java/org/opennms/api/integration/ticketing/Ticket.java">Ticket.java</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">$alarm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/OpenNMS/opennms/blob/opennms-32.0.5-1/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsAlarm.java">OnmsAlarm.java</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">$node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/OpenNMS/opennms/blob/opennms-32.0.5-1/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsNode.java">OnmsNode.java</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_logging_ni2_plugin">logging ni2 plugin</h5>
<div class="paragraph">
<p>Note that in these examples the <code>DEBUG</code> setting is useful for testing but <code>INFO</code> should be used for normal operation.</p>
</div>
<div class="paragraph">
<p>Logging happens in two places for the Ni2 plugin.</p>
</div>
<div class="paragraph">
<p>Firstly the generic OpenNMS ticketer code generates logs in <code>-opennms-home-/logs/trouble-tickter.log</code></p>
</div>
<div class="paragraph">
<p>To see trouble-ticketer debug logs change <code>-opennms-home-/etc/log4j2.xml</code> adding a new routing appender and change trouble-ticketer from INFO to DEBUG</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>    &lt;logger name="org.ni2.v01" additivity="false" level="DEBUG"&gt;
     &lt;appender-ref ref="RoutingAppender"/&gt;
    &lt;/logger&gt;

    &lt;!-- Allow any message to pass through the root logger --&gt;
    &lt;root level="DEBUG"&gt;
        ...
        &lt;KeyValuePair key="trouble-ticketer"     value="DEBUG" /&gt;
        ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Secondly the ni2 OSGi plugin generates logs in <code>-opennms-home-/logs/karaf.log</code></p>
</div>
<div class="paragraph">
<p>However these logs can be directed to a separate file <code>-opennms-home-/logs/ni2-ticketing-plugin.log</code> by adding the following configuration to the end of <code>-opennms-home-/etc/org.ops4j.pax.logging.cfg</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code># logger for ni2 plugins
log4j2.logger.ni2.name = org.ni2
log4j2.logger.ni2.level = DEBUG
log4j2.logger.ni2.additivity = true
log4j2.logger.ni2.appenderRef.Ni2PluginRollingFile.ref = Ni2PluginRollingFile

# Rolling file appender for ni2 plugins
log4j2.appender.plugin.type = RollingRandomAccessFile
log4j2.appender.plugin.name = Ni2PluginRollingFile
log4j2.appender.plugin.fileName = ${karaf.log}/ni2-ticketing-plugin.log
log4j2.appender.plugin.filePattern = ${karaf.log}/ni2-ticketing-plugin.log.%i
log4j2.appender.plugin.append = true
log4j2.appender.plugin.layout.type = PatternLayout
log4j2.appender.plugin.layout.pattern = ${log4j2.pattern}
log4j2.appender.plugin.policies.type = Policies
log4j2.appender.plugin.policies.size.type = SizeBasedTriggeringPolicy
log4j2.appender.plugin.policies.size.size = 16MB</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_running_and_testing_the_plugin">3.4. Running and Testing the Plugin</h3>
<div class="paragraph">
<p>Having made the changes above, start OpenNMS and wait for it to start up.</p>
</div>
<div class="paragraph">
<p>OpenNMS uses Karaf to manage it&#8217;s OSGi features.</p>
</div>
<div class="paragraph">
<p>Karaf has a CLI terminal which can be accessed using SSH.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>ssh -p 8101 admin@localhost</code></pre>
</div>
</div>
<div class="paragraph">
<p>(You will need to supply the password for admin to login)</p>
</div>
<div class="paragraph">
<p>A full list of native karaf commands are available here: <a href="https://karaf.apache.org/manual/latest/#_commands">native Karaf 4 commands</a></p>
</div>
<div class="paragraph">
<p>A list of OpenNMS utility commands are documented here: <a href="https://opennms.discourse.group/t/karaf-cli-cheat-sheet/149">OpenNMS Karaf cheat sheet</a></p>
</div>
<div class="paragraph">
<p>You can list any Kar files in the deploy directory</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>kar:list
KAR Name
ni2-tt-api-v1-kar-0.0.3-SNAPSHOT</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also list the features available using</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>feature:list</code></pre>
</div>
</div>
<div class="paragraph">
<p>or to see the status of the ticketing plugin use</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code> feature:list | grep ni2-ticketing
ni2-ticketing | 0.0.3.SNAPSHOT        | x | Started     | ni2-ticketing-features | OpenNMS :: OPA :: Ticketing :: Ni2</code></pre>
</div>
</div>
<div class="paragraph">
<p>The plugin can be installed automatically (as described above ) or manually from the terminal using</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>feature:install ni2-ticketing</code></pre>
</div>
</div>
<div class="paragraph">
<p>A number of commands are also provided to allow testing of the plugin</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">command</th>
<th class="tableblock halign-left valign-top">details</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-ticketing --help</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lists help for commands</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-ticketing:create-remote-ticket</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create a new ticket in remote system. (Note - this does not link a ticket to an alarm in OpenNMS)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-ticketing:update-remote-ticket</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Update an existing ticket in remote system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-ticketing:change-status</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Change status of a ticket</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-ticketing:get-auth-token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get an authentication token</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-ticketing:get-ticket</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get a trouble ticket using a ticket id</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example which gets an auth token using the default credentials</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>ni2-ticketing:get-auth-token
get-auth-token trying to get auth token serverUrl=https://demo-deck-apigtw.ni2.tech username=APIOpenNMS password not shown trustAllCertificates=true
received Authentication Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IkFQSU9wZW5OTVMiLCJpYXQiOjE3MjEyMzA5MTR9.9t0SYbC3WQSUYN3cHii-nTV_9d2iEFKHGCy7I6FD3kg</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example which creates a remote ticket using the default credentials</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>ni2-ticketing:create-remote-ticket --description 'this is a short message' --longdescription 'this is a long message'
create-remote-ticket trying to create ticket. serverUrl=https://demo-deck-apigtw.ni2.tech username=APIOpenNMS password not shown trustAllCertificates=true
sending ticket request:TroubleTicketCreateRequest [getClassificationPath()=Event("Event/Support/Incident/Monitoring Incident"), getDescription()=this is a short message, getLongDescription()=this is a long message, getResourceIds()=[monaco_01], getCategory()=Network, getAlarmSource()=OpenNMS1, getAlarmId()=48278, getAlarmSeverity()=Minor, getAlarmStatus()=Unacknowledged]
success: response=TroubleTicketCreateResponse [universalId=EVT-00012580, url=/api/v1/entity/event/get/event/base/EVT-00012580]</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga-develop">4. Ni2 OpenNMS Trouble Ticket Plugin Developers Guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Welcome to the Ni2 OpenNMS Trouble Ticket Plugin <em>Developers Guide</em>.
This documentation provides information for developers of the  Ni2 OpenNMS Trouble Ticket Plugin.</p>
</div>
<div class="sect2">
<h3 id="_introduction_2">4.1. Introduction</h3>
<div class="paragraph">
<p>THe figure below illustrates the relationship between the OpenNMS core and OSGi components running in Karaf</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/admin/architecture-1.drawio.png" alt="OpenNMS Core Architecture">
</div>
</div>
<div class="paragraph">
<p>Historically, OpenNMS was developed as a pure Spring application using Hibernate to implement Data Access Objects (DAO&#8217;s) which synchronise with the PostgreSQL database.</p>
</div>
<div class="paragraph">
<p>Each of the core daemons are managed as JMX beans running within Spring on top of the JVM.</p>
</div>
<div class="paragraph">
<p>When minions were developed it was realised that there would be great benefit in moving OpenNMS to use Karaf as an OSGi container framework as this would allow the same OpenNMS modules to be distributed easily and also provide an 'out of the box' plugin mechanism.
Karaf activates OSGi modules as karaf 'features' and the features internally use OSGi Blueprint instead of Spring manifests (although these are very similar).</p>
</div>
<div class="paragraph">
<p>New code and enhancements to OpenNMS including plugins are now usually created as Karaf features however a number of core daemons such as Jetty, Alarmd, Eventd, Provisiond and Collectd still run in Spring.</p>
</div>
<div class="paragraph">
<p>For this reason, Karaf currently runs on top of Jetty which allows Karaf features to access the core system.
Over time all of he daemons will be migrated so that the whole of OpenNMS runs in Karaf and then Jetty is run as a karaf module instead of the other way around.</p>
</div>
<div class="paragraph">
<p>The Ni2 OpenNMS Trouble Ticket Plugin has been developed as an OSGi plugin which uses the <a href="https://github.com/OpenNMS/opennms-integration-apiOpenNMS" class="bare">https://github.com/OpenNMS/opennms-integration-apiOpenNMS</a> Integration API to access the core OpenNMS services.</p>
</div>
</div>
<div class="sect2">
<h3 id="_building_the_plugin">4.2. building the plugin</h3>
<div class="paragraph">
<p>The source code for the plugin is held in github here <a href="https://github.com/gallenc/ni2-opennms-trouble-ticket-plugin" class="bare">https://github.com/gallenc/ni2-opennms-trouble-ticket-plugin</a></p>
</div>
<div class="paragraph">
<p>Once you have checked out the code, you can build the plugin using maven and (at least) Java 11 JDK.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>cd ni2-tt-api-v1
mvn clean install</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once built, the plugin will be in a kar file in <code>ni2-tt-api-v1/assembly/kar/target/ni2-tt-api-v1-kar-x.x.x-SNAPSHOT.kar</code></p>
</div>
<div class="paragraph">
<p>The build tests the plugin against a mock Ni2 API which is run in Jetty during the test phase.</p>
</div>
<div class="paragraph">
<p>A docker compose project is also provided in which the build will install the plugin kar.
This project can be used to test the plugin in a test OpenNMS container either against the mock api or, with the right configuration, against a real Ni2 system.</p>
</div>
</div>
<div class="sect2">
<h3 id="_maven_modules">4.3. Maven Modules</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">folder</th>
<th class="tableblock halign-left valign-top">maven module name</th>
<th class="tableblock halign-left valign-top">details</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-tt-api-v1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-tt-api-v1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">parent project</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">model</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-tt-api-v1-model</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jackson model used to marshal and unmarshal the API. THe model is built first as it is used in the mock impl as well as the core code.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">jersey-mock-impl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-tt-api-v1-mock-impl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mock Ni2 test implementation which can run in Jetty. This can be run stand alone using 'mvn jetty:run'.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">core</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-tt-api-v1-core</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The main code of the plugin including test code. The tests are run against the mock implementation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">karaf-features</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-tt-api-v1-karaf-features</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Karaf features project used to generate the features file which defines the plugin and is also included in the kar file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">assembly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-tt-api-v1-assembly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">parent project of the assembly</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">assembly/kar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-tt-api-v1-kar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The plugin is built as a kar in the target folder. Note that the bundle dependencies not available in the core OpenNMS will also be package in the kar.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">minimal-minion-activemq</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-tt-api-v1-minimal-minion-activemq</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is a docker compose project which can be used to test and demonstrate the plugin</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">documentation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-tt-api-v1-documentation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is the ascidoc documentation for the plugin. Docs are rendered as PDF and as HTML. The HTML files should be placed in the github docs branch so that they show up as a documentation page on github</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">documentation/guide-admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ni2-tt-api-v1-guide-admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Admin Guide</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
 Ni2 OpenNMS Trouble Ticket Plugin 0.0.3-SNAPSHOT<br>
Last updated 2024-07-17 17:41:57 +0100
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>